import{f as m,g as x,h as R,c as u,a as s,i as P,j as c,v as g,u as r,F as S,r as k,k as v,t as b,l as B,d as C,o as d}from"./index-DmT5nx1Y.js";import{L as D}from"./localbase-Dun8nI1D.js";import{u as E}from"./useReservas-BOWCV_yZ.js";function I(){let l;const i=m([]),t=x({nome:"",materia:""});R(()=>{l=new D("dbReserv"),o()});const o=async()=>{try{if(!l){console.warn("DB não inicializado. Tentando capturar professores mais tarde.");return}i.value=await l.collection("professores").get({keys:!0})}catch(n){console.error("Erro ao buscar professores:",n)}};return{professores:i,form:t,capturarProfessores:o,adicionarProfessor:async()=>{if(!t.nome||!t.materia)return alert("Por favor, preencha o nome e a matéria."),!1;try{return await l.collection("professores").add({nome:t.nome,materia:t.materia,dataCadastro:new Date().toISOString()}),t.nome="",t.materia="",await o(),!0}catch(n){return console.error("Erro ao salvar professor:",n),!1}}}}function M(){let l;const i=m([]),t=x({nome:""}),o=async()=>{if(l)try{i.value=await l.collection("salas").get()}catch(n){console.error("Erro ao buscar salas:",n)}};return R(()=>{l=new D("dbReserv"),o()}),{salas:i,form:t,adicionarSala:async()=>{if(!t.nome)return!1;try{return await l.collection("salas").add({nome:t.nome,dataCadastro:new Date().toISOString()}),t.nome="",await o(),!0}catch(n){return console.error("Erro ao salvar sala:",n),!1}},capturarSalas:o}}const U={class:"w-full"},T={class:"fieldset bg-base-200 border-base-300 rounded-box w-full border p-4"},j=["value"],L=["value"],z={class:"flex gap-4"},A={class:"flex-1"},H={class:"flex-1"},K={key:0,class:"toast"},N={role:"alert",class:"alert alert-success"},G={__name:"add",setup(l){const i=C(),{professores:t}=I(),{form:o,reservarSala:p}=E(),{salas:n}=M(),f=m(!1),y=m(""),F=()=>{i.push("/reserva")},V=async()=>{const w=o.nome;await p()&&(y.value=w,f.value=!0,setTimeout(()=>{f.value=!1},3e3))};return(w,e)=>(d(),u("div",U,[s("form",{onSubmit:B(V,["prevent"])},[s("fieldset",T,[e[10]||(e[10]=s("legend",{class:"fieldset-legend"},"Reservando Salas",-1)),e[11]||(e[11]=s("label",{class:"label"},"Sala",-1)),c(s("select",{class:"select w-full","onUpdate:modelValue":e[0]||(e[0]=a=>r(o).nome=a)},[e[5]||(e[5]=s("option",{value:"",disabled:"",selected:""},"Selecione Sala",-1)),(d(!0),u(S,null,k(r(n),a=>(d(),u("option",{key:a.key,value:a.nome},b(a.nome),9,j))),128))],512),[[g,r(o).nome]]),e[12]||(e[12]=s("label",{class:"label"},"Responsável",-1)),c(s("select",{class:"select w-full","onUpdate:modelValue":e[1]||(e[1]=a=>r(o).responsavelKey=a)},[e[6]||(e[6]=s("option",{value:"",disabled:"",selected:""},"Selecione Professor",-1)),(d(!0),u(S,null,k(r(t),a=>(d(),u("option",{key:a.key,value:a.key},b(a.data.nome),9,L))),128))],512),[[g,r(o).responsavelKey]]),e[13]||(e[13]=s("h3",{class:"mt-4 text-lg font-medium"},"Período da Reserva",-1)),e[14]||(e[14]=s("label",{class:"label"},"Data da Reserva",-1)),c(s("input",{type:"date",class:"input w-full","onUpdate:modelValue":e[2]||(e[2]=a=>r(o).dataReserva=a)},null,512),[[v,r(o).dataReserva]]),s("div",z,[s("div",A,[e[7]||(e[7]=s("label",{class:"label"},"Hora de Início",-1)),c(s("input",{type:"time",class:"input w-full","onUpdate:modelValue":e[3]||(e[3]=a=>r(o).horaInicio=a)},null,512),[[v,r(o).horaInicio]])]),s("div",H,[e[8]||(e[8]=s("label",{class:"label"},"Hora de Fim",-1)),c(s("input",{type:"time",class:"input w-full","onUpdate:modelValue":e[4]||(e[4]=a=>r(o).horaFim=a)},null,512),[[v,r(o).horaFim]])])]),s("div",{style:{display:"flex","justify-content":"center","align-items":"center",gap:"500px"}},[e[9]||(e[9]=s("button",{class:"btn mt-4 text-gray-800",style:{"background-color":"#A9DFD9","border-color":"#A9DFD9",width:"200px"},type:"submit"}," Salvar ",-1)),s("button",{class:"btn mt-4 text-gray-800",style:{"background-color":"#F08080","border-color":"#F08080",width:"200px"},onClick:F,type:"button"}," Voltar ")])]),f.value?(d(),u("div",K,[s("div",N,[e[15]||(e[15]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 shrink-0 stroke-current",fill:"none",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("span",null,"Reserva da Sala "+b(y.value)+" salva com sucesso.",1)])])):P("",!0)],32)]))}};export{G as default};
